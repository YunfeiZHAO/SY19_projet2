test<-matrix(test, 100, 100)
image(test)
test<-car[3,]
test<-matrix(test, 100, 100)
image(test)
test<-car[5,]
test<-matrix(test, 100, 100)
image(test)
test<-car[1,]
test<-matrix(test, 100, 100)
image(test)
test<-car[2,]
test<-matrix(test, 100, 100)
image(test)
test<-car[3,]
test<-matrix(test, 100, 100)
image(test)
path
list.files(path)
test<-car[10,]
test<-matrix(test, 100, 100)
image(test)
test<-car[2,]
test<-matrix(test, 100, 100)
image(test)
fn <- paste(path, i, sep = "")
im <- load.image(fn)
image(im)
plot(im)
## change to gray image of size 100*100
im <- resize(im, size_x = 100L, size_y = 100L,
size_z = 1L, size_c = 1L)
plot(im)
fn <- paste(path, i, sep = "")
im <- load.image(fn)
plot(im)
## change to gray image of size 100*100
im <- resize(im, size_x = 100L, size_y = 100L,
size_z = 1L, size_c = 1L)
plot(im)
im <- as.array(im)
im <- matrix(im, 1, product(dim(im)))
new <- matrix(im, 100, 100)
image(new)
fn <- paste(path, i, sep = "")
im <- load.image(fn)
plot(im)
## change to gray image of size 100*100
im <- resize(im, size_x = 100L, size_y = 100L,
size_z = 1L, size_c = 1L)
plot(im)
im <- as.array(im)
image(im)
im <- matrix(im,100,100)
image(im)
imm <- matrix(im, 1, product(dim(im)))
new <- matrix(imm, 100, 100)
image(new)
a<-c(1,2,3,4)
m<-matrix(a, 2,2)
a
m
m<-matrix(a, 2,2，byrow = FALSE)
m<-matrix(a, 2,2,byrow = FALSE)
m
m<-matrix(a, 2,2,byrow = TRUE)
m
test<-car[2,]
test<-matrix(test, 100, 100, byrow = TRUE)
image(test)
new <- matrix(imm, 100, 100,byrow = TRUE)
image(new)
## change to gray image of size 100*100
im <- resize(im, size_x = 100L, size_y = 100L,
size_z = 1L, size_c = 1L)
plot(im)
im <- as.array(im)
im <- matrix(im,100,100,byrow = TRUE)
image(im)
fn <- paste(path, i, sep = "")
im <- load.image(fn)
plot(im)
## change to gray image of size 100*100
im <- resize(im, size_x = 100L, size_y = 100L,
size_z = 1L, size_c = 1L)
plot(im)
im <- as.array(im)
im <- matrix(im,100,100,byrow = TRUE)
image(im)
imm <- matrix(im, 1, product(dim(im)))
new <- matrix(imm, 100, 100,byrow = TRUE)
image(new)
fn <- paste(path, i, sep = "")
im <- load.image(fn)
plot(im)
## change to gray image of size 100*100
im <- resize(im, size_x = 100L, size_y = 100L,
size_z = 1L, size_c = 1L)
plot(im)
im <- matrix(im,100,100)
image(im)
imm <- matrix(im, 1, product(dim(im)))
new <- matrix(imm, 100, 100,byrow = TRUE)
image(new)
fn <- paste(path, i, sep = "")
im <- load.image(fn)
plot(im)
## change to gray image of size 100*100
im <- resize(im, size_x = 100L, size_y = 100L,
size_z = 1L, size_c = 1L)
plot(im)
fn <- paste(path, i, sep = "")
im <- load.image(fn)
plot(im)
## change to gray image of size 100*100
im <- resize(im, size_x = 100L, size_y = 100L,
size_z = 1L, size_c = 1L)
plot(im)
fn <- paste(path, i, sep = "")
im <- load.image(fn)
plot(im)
## change to gray image of size 100*100
im <- resize(im, size_x = 100L, size_y = 100L,
size_z = 1L, size_c = 1L)
plot(im)
im <- matrix(im,100,100)
image(im)
fn <- paste(path, i, sep = "")
im <- load.image(fn)
plot(im)
## change to gray image of size 100*100
im <- resize(im, size_x = 100L, size_y = 100L,
size_z = 1L, size_c = 1L)
plot(im)
im <- matrix(im,100,100, byrow = TRUE)
image(im)
fn <- paste(path, i, sep = "")
im <- load.image(fn)
plot(im)
## change to gray image of size 100*100
im <- resize(im, size_x = 100L, size_y = 100L,
size_z = 1L, size_c = 1L)
plot(im)
view(im)
View(im)
View(im)
im
test<-t(matrix(test, 100, 100, byrow = TRUE))
image(test)
test<-car[1,]
test<-t(matrix(test, 100, 100))
image(test)
test<-t(matrix(test, 100, 100), byrow=TRUE)
image(test)
test<-car[1,]
test<-t(matrix(test, 100, 100))
test<-car[1,]
test<-(matrix(test, 100, 100, byrow=TRUE))
image(test)
test<-car[1,]
test<-matrix(test, 100, 100, byrow=TRUE)
image(test)
test<-car[1,]
test<-t(matrix(test, 100, 100))
image(test)
test<-matrix(test, 100, 100)
image(test)
test<-car[1,]
test<-matrix(test, 100, 100)
image(test)
View(car)
test<-car[1,]
test<-matrix(test, 100, 100)
image(test)
test<-car[1,]
test<-t(matrix(test, 100, 100))
image(test)
test<-t(matrix(test, 100, 100))
image(test)
a<-matrix(2,2)
a
a<-matrix(c(1,2,3,4),2,2)
a
# data splitting
n <- nrow(car) + nrow(cat) + nrow(flower)
n
ntrain <- 2*n/3
idx.train = sample(n, ntrain)
ntrain <- length(idx.train)
ntest <- n - ntrain
array(10)
a<-array(10)
a
y <- rep(1, nrow(car))
y
y1 <- rep(1, nrow(car))
y1 <- rep(1, nrow(car))
y2 <- rep(2, nrow(cat))
y3 <- rep(3, nrow(flower))
y <- cbind(y1, y2, y3)
y <- rbind(y1, y2, y3)
y <- cbind(y1, y2, y3)
y1
dim(y1)
y <- y1 + y2+ y3
y <- c(y1, y2, y3)
y
y(1000)
y[1000]
y[1500]
ytrain <- y[idx.trainImg]
# data splitting
n <- nrow(car) + nrow(cat) + nrow(flower)
y1 <- rep(1, nrow(car))
y2 <- rep(2, nrow(cat))
y3 <- rep(3, nrow(flower))
y <- c(y1, y2, y3)
ntrainImg <- 2*n/3
idx.trainImg = sample(n, ntrain)
ntrainImg <- length(idx.trainImg)
ntestImg <- n - ntrainImg
ytrainImg <- y[idx.trainImg]
ytestImg <- y[-idx.trainImg]
data.image<- rbind(car, cat, flower)
view(data.image)
View(data.image)
xtrainImg <- data.image[idx.trainImg]
xtestImg <- data.image[-idx.trainImg]
dim(xtrainImg)
View(xtrainImg)
View(data.image)
xtrainImg <- data.image[idx.trainImg,]
xtestImg <- data.image[-idx.trainImg,]
dim(xtrainImg)
length(ytrainImg)
# data splitting
n <- nrow(car) + nrow(cat) + nrow(flower)
y1 <- rep(1, nrow(car))
y2 <- rep(2, nrow(cat))
y3 <- rep(3, nrow(flower))
y <- c(y1, y2, y3)
ntrainImg <- 2*n/3
idx.trainImg = sample(n, ntrain)
ntrainImg <- length(idx.trainImg)
ntestImg <- n - ntrainImg
ytrainImg <- y[idx.trainImg]
ytestImg <- y[-idx.trainImg]
data.image<- rbind(car, cat, flower)
xtrainImg <- data.image[idx.trainImg,]
xtestImg <- data.image[-idx.trainImg,]
#kera
model <- keras_model_sequential()
y
y
#kera
model <- keras_model_sequential()
##############################3 Images naturelles###############################
library(keras)
library(imager)
#kera
model <- keras_model_sequential()
conda activate r-reticulate
#kera
model <- keras_model_sequential()
# data splitting
n <- nrow(car) + nrow(cat) + nrow(flower)
y1 <- rep(1, nrow(car))
y2 <- rep(2, nrow(cat))
y3 <- rep(3, nrow(flower))
y <- c(y1, y2, y3)
ntrainImg <- 2*n/3
idx.trainImg = sample(n, ntrain)
ntrainImg <- length(idx.trainImg)
ntestImg <- n - ntrainImg
ytrainImg <- y[idx.trainImg]
ytestImg <- y[-idx.trainImg]
data.image<- rbind(car, cat, flower)
xtrainImg <- data.image[idx.trainImg,]
xtestImg <- data.image[-idx.trainImg,]
#kera
model <- keras_model_sequential()
##############################3 Images naturelles###############################
library(keras)
library(imager)
#kera
model <- keras_model_sequential()
model %>% layer_dense(units = 30, activation = 'relu', input_shape = 10000) %>%
layer_dense(units = 20, activation = 'relu',name="cache1") %>%
layer_dense(units = 5, activation = 'relu',name="cache2") %>%
layer_dense(units = 3, activation = 'linear',name="sortie")
#kera
model <- keras_model_sequential()
car <- read.images("./data/images_train/car/")
cat <- read.images("./data/images_train/cat/")
View(data.image)
View(data.image)
classifieur_astronomie <- function(dataset) {
# Chargement de l’environnement
#load("env.Rdata")
load("./classifier_astronomie.RData")
# Mon algorithme qui renvoie les prédictions sur le jeu de données
# ‘dataset‘ fourni en argument. # ...
class <- dataset$class
# remove constant
X <- subset(dataset, select = -c(class, objid, rerun))
#scaling
X <- scale(X)
# PCA
astronomy<-X*pca$rotation
astronomy<-cbind(astronomy, class)
astronomy$class <- as.factor(astronomy$class)
predictions<-predict(fit.MLR.norm, newdata=astronomy)
return(predictions)
}
data <- read.csv("./data/astronomy_train.csv",sep=",",header=TRUE)
data <- read.csv("/Users/yunfei/Desktop/GI04/SY19/tp10/SY19_projet2/data/astronomy_train.csv ",sep=",",header=TRUE)
data <- read.csv("~/Desktop/GI04/SY19/tp10/SY19_projet2/data/astronomy_train.csv ",sep=",",header=TRUE)
data <- read.csv("/Users/yunfei/Desktop/GI04/SY19/tp10/SY19_projet2/data/astronomy_train.csv ",sep=",",header=TRUE)
setwd("/Users/yunfei/Desktop/GI04/SY19/tp10/SY19_projet2/")
data <- read.csv("./data/astronomy_train.csv ",sep=",",header=TRUE)
data <- read.csv("./data/astronomy_train.csv",sep=",",header=TRUE)
n <- nrow(data)
ntest <- 1000
idx <- sample(n, ntest)
predoction <- classifieur_astronomie(data[idx,])
View(classifieur_astronomie)
X
# Chargement de l’environnement
#load("env.Rdata")
load("./classifier_astronomie.RData")
# Mon algorithme qui renvoie les prédictions sur le jeu de données
# ‘dataset‘ fourni en argument. # ...
class <- dataset$class
dataset<-data
# Chargement de l’environnement
#load("env.Rdata")
load("./classifier_astronomie.RData")
# Mon algorithme qui renvoie les prédictions sur le jeu de données
# ‘dataset‘ fourni en argument. # ...
class <- dataset$class
# remove constant
X <- subset(dataset, select = -c(class, objid, rerun))
#scaling
X <- scale(X)
# PCA
astronomy<-X*pca$rotation
View(X)
View(pca$rotation)
# PCA
astronomy<-pca$rotation*X
# PCA
astronomy<-X*pca$rotation
setwd("/Users/yunfei/Desktop/GI04/SY19/tp10/SY19_projet2/")
data <- read.csv("./data/astronomy_train.csv",sep=",",header=TRUE)
n <- nrow(data)
ntest <- 1000
idx <- sample(n, ntest)
predoction <- classifieur_astronomie(data[idx,])
# Chargement de l’environnement
#load("env.Rdata")
load("./classifier_astronomie.RData")
classifieur_astronomie <- function(dataset) {
# Chargement de l’environnement
#load("env.Rdata")
load("./classifier_astronomie.RData")
# Mon algorithme qui renvoie les prédictions sur le jeu de données
# ‘dataset‘ fourni en argument. # ...
class <- dataset$class
# remove constant
X <- subset(dataset, select = -c(class, objid, rerun))
#scaling
X <- scale(X)
# PCA
astronomy<-X%*%pca$rotation
astronomy<-cbind(astronomy, class)
astronomy$class <- as.factor(astronomy$class)
predictions<-predict(fit.MLR.norm, newdata=astronomy)
return(predictions)
}
classifieur_astronomie <- function(dataset) {
# Chargement de l’environnement
#load("env.Rdata")
load("./classifier_astronomie.RData")
# Mon algorithme qui renvoie les prédictions sur le jeu de données
# ‘dataset‘ fourni en argument. # ...
class <- dataset$class
# remove constant
X <- subset(dataset, select = -c(class, objid, rerun))
#scaling
X <- scale(X)
# PCA
astronomy<-X%*%pca$rotation
astronomy<-cbind(astronomy, class)
astronomy$class <- as.factor(astronomy$class)
predictions<-predict(fit.MLR.norm, newdata=astronomy)
return(predictions)
}
setwd("/Users/yunfei/Desktop/GI04/SY19/tp10/SY19_projet2/")
data <- read.csv("./data/astronomy_train.csv",sep=",",header=TRUE)
n <- nrow(data)
ntest <- 1000
idx <- sample(n, ntest)
predoction <- classifieur_astronomie(data[idx,])
classifieur_astronomie <- function(dataset) {
# Chargement de l’environnement
#load("env.Rdata")
load("./classifier_astronomie.RData")
# Mon algorithme qui renvoie les prédictions sur le jeu de données
# ‘dataset‘ fourni en argument. # ...
class <- dataset$class
# remove constant
X <- subset(dataset, select = -c(class, objid, rerun))
#scaling
X <- scale(X)
# PCA
astronomy<-X%*%pca$rotation
astronomy<-cbind(astronomy, class)
View(astronomy)
astronomy$class <- as.factor(astronomy$class)
predictions<-predict(fit.MLR.norm, newdata=astronomy)
return(predictions)
}
classifieur_astronomie <- function(dataset) {
# Chargement de l’environnement
#load("env.Rdata")
load("./classifier_astronomie.RData")
# Mon algorithme qui renvoie les prédictions sur le jeu de données
# ‘dataset‘ fourni en argument. # ...
class <- dataset$class
# remove constant
X <- subset(dataset, select = -c(class, objid, rerun))
#scaling
X <- scale(X)
# PCA
astronomy<-X%*%pca$rotation
astronomy<-cbind(astronomy, class)
View(astronomy)
astronomy$class <- as.factor(astronomy$class)
predictions<-predict(fit.MLR.norm, newdata=astronomy)
return(predictions)
}
setwd("/Users/yunfei/Desktop/GI04/SY19/tp10/SY19_projet2/")
data <- read.csv("./data/astronomy_train.csv",sep=",",header=TRUE)
n <- nrow(data)
ntest <- 1000
idx <- sample(n, ntest)
predoction <- classifieur_astronomie(data[idx,])
setwd("/Users/yunfei/Desktop/GI04/SY19/tp10/SY19_projet2/")
data <- read.csv("./data/astronomy_train.csv",sep=",",header=TRUE)
n <- nrow(data)
ntest <- 1000
idx <- sample(n, ntest)
predoction <- classifieur_astronomie(data[idx,])
classifieur_astronomie <- function(dataset) {
# Chargement de l’environnement
#load("env.Rdata")
load("./classifier_astronomie.RData")
# Mon algorithme qui renvoie les prédictions sur le jeu de données
# ‘dataset‘ fourni en argument. # ...
class <- dataset$class
# remove constant
X <- subset(dataset, select = -c(class, objid, rerun))
#scaling
X <- scale(X)
# PCA
astronomy<-data.frame(X%*%pca$rotation)
astronomy<-cbind(astronomy, class)
View(astronomy)
astronomy$class <- as.factor(astronomy$class)
predictions<-predict(fit.MLR.norm, newdata=astronomy)
return(predictions)
}
classifieur_astronomie <- function(dataset) {
# Chargement de l’environnement
#load("env.Rdata")
load("./classifier_astronomie.RData")
# Mon algorithme qui renvoie les prédictions sur le jeu de données
# ‘dataset‘ fourni en argument. # ...
class <- dataset$class
# remove constant
X <- subset(dataset, select = -c(class, objid, rerun))
#scaling
X <- scale(X)
# PCA
astronomy<-data.frame(X%*%pca$rotation)
astronomy<-cbind(astronomy, class)
View(astronomy)
astronomy$class <- as.factor(astronomy$class)
predictions<-predict(fit.MLR.norm, newdata=astronomy)
return(predictions)
}
setwd("/Users/yunfei/Desktop/GI04/SY19/tp10/SY19_projet2/")
data <- read.csv("./data/astronomy_train.csv",sep=",",header=TRUE)
n <- nrow(data)
ntest <- 1000
idx <- sample(n, ntest)
predoction <- classifieur_astronomie(data[idx,])
library(nnet)
data <- read.csv("./data/astronomy_train.csv",sep=",",header=TRUE)
n <- nrow(data)
ntest <- 1000
idx <- sample(n, ntest)
prediction <- classifieur_astronomie(data[idx,])
matrix.conf <- table(prediction, data[idx, "class"])
matrix.conf
err <- 1 - sum(diag(matrix.conf))/ntest
err
pca.rotation <- pca$rotation
load("./classifier_astronomie.RData")
pca.rotation <- pca$rotation
save(fit.MLR.norm, file = "env.RData")
save(pca.rotation, file = "env.RData")
